<!doctype html>
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <title>P-Code Playground</title>
    <link rel="stylesheet" href="style.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="/main.js"></script>
  </head>

  <body>
    <main id="app"
      x-data="appComponents.cmdr()"
      x-on:keydown.window="autoFocus($event)"
      x-init="init">

      <div class="fixed-pane vertical">
        <!-- // server history view -->
        <article class="server">
          <header x-text="tabText"></header>
          <template x-for="(item, index) in serverHistory" :key="index">
            <div class="item">
              <span x-bind:style="`color:${item.color}; padding-right:0.66rem; font-weight:800;`" x-text="item.username"></span>
              <span x-text="item.message"></span>
            </div>
          </template>
        </article>

        <!-- // user history view -->
        <template x-if="showHistory == 'local'">
          <article class="user local">
            <header>local message history</header>
            <template
              x-for="(item, index) in inputHistory"
              :key="index">
              <div x-text="item"
                x-bind:class="{ item: true, hl: index == localHistoryIndex }"></div>
            </template>
          </article>
        </template>

        <!-- // server history view -->
        <template x-if="showHistory == 'server'">
          <article class="user public">
            <header>server message history</header>
            <template
              x-for="(item, index) in serverHistory"
              :key="index">
              <div class="item"
                x-bind:class="{ item: true, hl: index == serverHistoryIndex }">
                <span x-bind:style="`color:${item.color}; padding-right:0.66rem; font-weight:800;`" x-text="item.username"></span>
                <span x-text="item.message"></span>
              </div>
            </template>
          </article>
        </template>
      </div>

      <div class="fixed-pane vertical"
        style="background:rgba(0,0,0,.8);"
        x-show="showHelp">
        <!-- // help -->
        <article class="help">
          <header>help</header>
          <div class="item">
            retype <span class="cmdhelp">'$ help'</span> or <span class="cmdhelp">'ESC'</span> key to close this pane</span>
          </div>
          <div class="item">
            <span class="cmdhelp">'PgUp' / 'PgDn'</span>
            <span> key recalls local history, back / forward</span><br>
            (* w/ history pane,  <span class="cmdhelp">'ESC'</span> key to close this pane)
          </div>
          <div class="item">
            <span class="cmdhelp">'SHIFT' + 'PgUp' / 'SHIFT' + 'PgDn'</span>
            <span> key recalls server history, back / forward</span><br>
            (* w/ history pane, <span class="cmdhelp">'ESC'</span> key to close this pane)
          </div>
        </article>
      </div>

      <div class="fixed-pane bottom">
        <section>
          <input placeholder="Please type '$ help' here for usages" type="text"
            x-model="currentInput"
            x-on:keydown="downAction($event)"
            x-on:keyup="upAction($event)" />
        </section>
      </div>

      <template x-if="!isLogin">
        <div class="fixed-pane center">
          <section class="login page">
            <div class="form">
              <input placeholder="What's your nickname?" type="text" class="usernameInput"
                x-model="userName"
                x-on:keyup="loginAction($event)" />
            </div>
          </section>
        </div>
      </template>

    </main>
  </body>

</html>
